!function(e){e(window.jQuery,window,document)}(function(e,i){wpCircleMenuMain=this.wpCircleMenuMain||{},e(function(){"use strict";wpCircleMenuMain={init:function(){var i={circle_radius:e("#wpcm-circle_radius").val(),direction:e("#wpcm-direction").val(),speed:e("#wpcm-speed").val(),step_in:e("#wpcm-step_in").val(),step_out:e("#wpcm-step_out").val(),transition_function:e("#wpcm-transition_function").val(),trigger:e("#wpcm-trigger").val(),closedImg:e(".wpcm-trigger_icon_closed .wpcm_upload_image_input").val(),openedImg:e(".wpcm-trigger_icon_opened .wpcm_upload_image_input").val()};void 0!==e("#wpcm-transition_function option:selected").data("extra")&&(i.transition_function_extra=e("#wpcm-transition_function option:selected").data("extra")),e("#wpcm-preview-menu").circleMenu(i),wpCircleMenuMain.propListeners(),wpCircleMenuMain.previewLinkImages(),wpCircleMenuMain.uploadImage(),wpCircleMenuMain.mainMenuActions();var n=e("input[name=wpcm-bshadow]:checked").val();"0"==n&&e(".wpcm-link-opener").css("box-shadow","none")},mainMenuActions:function(){e(".wpcm-save-creation").on("click",function(i){if(i.preventDefault(),""!=e("#wpcm_creation_name").val()){var n=(e(".wpcm-trigger_icon_closed").find(".wpcm_upload_image_input").val(),e(".wpcm-trigger_icon_opened").find(".wpcm_upload_image_input").val(),[]);e.each(e(".wpcm-url-inputs div.wpcm-each-link-edit"),function(i,a){var t=e(a).find(".wpcm_upload_image_input").val(),c=e(a).find(".wpcm-each-link-edit-item").val();n.push({img:t,url:c})}),void 0!==e(this).data("extra")&&(a[prop+"_extra"]=e(this).data("extra")),void 0!==e("option:selected",this).data("extra")&&(a[prop+"_extra"]=e("option:selected",this).data("extra"));var a={action:"wpcm_save_bm",save_settings:{name:e("#wpcm_creation_name").val(),items_position:e("#wpcm-direction").val(),trigger:e("#wpcm-trigger").val(),show_effect:e("#wpcm-transition_function").val(),show_effect_extra:null,radius:e("#wpcm-circle_radius").val(),open_close_speed:e("#wpcm-speed").val(),spread_speed:e("#wpcm-step_in").val(),collapse_speed:e("#wpcm-step_out").val(),links:n,closedImg:e(".wpcm-trigger_icon_closed .wpcm_upload_image_input").val(),openedImg:e(".wpcm-trigger_icon_opened .wpcm_upload_image_input").val(),bshadow:e("input[name=wpcm-bshadow]:checked").val()}};void 0!==e("#wpcm-transition_function option:selected").data("extra")&&(a.save_settings.show_effect_extra=e("#wpcm-transition_function option:selected").data("extra")),e.ajax({url:ajaxurl,type:"POST",data:a,success:function(e){alert(e.success?"Successfully Saved!":"Failed to save. Try again.")},fail:function(e){console.log("response ",e)}})}else alert("Name cannot be empty. Please provide a name before saving.")})},uploadImage:function(){e(".wpcm_upload_image_button").click(function(){wpCircleMenuMain.uploadImageButton=e(this),wpCircleMenuMain.img_input=e(this).prev(".wpcm_upload_image_input");wpCircleMenuMain.img_input.attr("name");return tb_show("","media-upload.php?type=image&TB_iframe=true"),!1}),i.send_to_editor=function(i){var n=e("img",i).attr("src");wpCircleMenuMain.img_input.val(n),wpCircleMenuMain.uploadImageButton.css("background-image","url("+n+")"),tb_remove()}},previewLinkImages:function(){e.each(e(".wpcm-each-link-edit"),function(i,n){var a=e(n).find(".wpcm_upload_image_input").val();e(n).find(".wpcm-link-img-preview").css("background-image","url("+a+")")}),e.each(e(".wpcm-trigger_icon > div"),function(i,n){var a=e(n).find(".wpcm_upload_image_input").val();e(n).find(".wpcm-link-img-preview").css("background-image","url("+a+")")})},propListeners:function(){e(".wpcm-delete-item").off("click"),e(".wpcm-delete-item").on("click",function(){var i={action:"wpcm_delete_bm",idx:this.id.replace("wpcm_del_","")};e.ajax({url:ajaxurl,type:"POST",data:i,success:function(e){alert(e.success?"Successfully Deleted!":"Failed to delete. Try again.")},fail:function(e){console.log("response ",e)}})}),e(".wpcm-prop").on("change",function(e){e.preventDefault(),wpCircleMenuMain.triggerPropVal()}),e("input[name=wpcm-bshadow]").on("change",function(e){e.preventDefault(),wpCircleMenuMain.triggerPropVal()}),e(".wpcm-link-menu-add").on("click",function(i){i.preventDefault(),e(".wpcm-url-inputs .wpcm-each-link-edit").length<4&&e(".wpcm-url-inputs").append('<div class="wpcm-each-link-edit"> <input class="wpcm_upload_image_input" type="hidden" size="36" class="hidden" name="ad_image" value="'+e("#wpcm-plugin-url").val()+'css/images/target.png"/> <input class="wpcm_upload_image_button wpcm-link-img-preview" type="button" style="background-image:url('+e("#wpcm-plugin-url").val()+'css/images/target.png);" value=""/> <input class="wpcm-each-link-edit-item" type="text" placeholder="Link Url"><a class="button wpcm-link-menu-remove">-</a><div style="clear: both"></div> </div>'),wpCircleMenuMain.uploadImage()}),e(".wpcm-link-menu-remove").on("click",function(i){i.preventDefault(),e(".wpcm-url-inputs .wpcm-each-link-edit").length>1&&e(this).parent().remove()}),e(".wpcm-link-menu-set").on("click",function(i){i.preventDefault(),e("#wpcm-preview-menu .wpcm-link-wrapper").remove(),e.each(e(".wpcm-url-inputs .wpcm-each-link-edit"),function(i,n){var a=e(n).find(".wpcm-each-link-edit-item").val(),t=e(n).find(".wpcm_upload_image_input").val();wpCircleMenuMain.updateLinks(a,t)}),wpCircleMenuMain.triggerPropVal()})},updateLinks:function(i,n){e("#wpcm-preview-menu").append('<li class="wpcm-link-wrapper"><a class="wpcm-each-link" href="'+i+'"><img class="wpcm-link-img"src="'+n+'"/></a></li>')},triggerPropVal:function(){var i={};e.each(e(".wpcm-prop"),function(n,a){var t=e(a).val(),c=a.id.replace("wpcm-","");e.isNumeric(t)&&(t=parseInt(t)),void 0!==e(this).data("extra")&&(i[c+"_extra"]=e(this).data("extra")),void 0!==e("option:selected",this).data("extra")&&(i[c+"_extra"]=e("option:selected",this).data("extra")),i[c]=t}),i.closedImg=e(".wpcm-trigger_icon_closed .wpcm_upload_image_input").val(),i.openedImg=e(".wpcm-trigger_icon_opened .wpcm_upload_image_input").val(),e("#wpcm-preview-menu").circleMenu(i,!0);var n=e("input[name=wpcm-bshadow]:checked").val();"0"==n&&e(".wpcm-link-opener").css("box-shadow","none")}},wpCircleMenuMain.init()})});